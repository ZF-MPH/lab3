---
title: "laboratory3"
author: "Mandi, Esmeralda, Zach F"
date: "1/31/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(here)
library(rio)
library(tidyverse)
library(gghighlight)
library(colorBlindness)
library(ggrepel)
library(scales)
library(ggthemes)
library(readr)
```

```{r}
honey <- import(here("data", "honeyproduct1.csv"))
```

## Number 1
Visualize the **total production of honey** across **years** by **state**
Use color to **highlight the west coast** (Washington, Oregon, and California) with a different color used for each west coast state.

```{r}
honey_region <- honey %>% 
  mutate(region = ifelse(state %in% c("OR", "CA", "WA"), "West Coast", "Other"))

plot <- ggplot(honey_region, aes(year, totalprod)) +
  geom_point(color = "grey80") +
  geom_point(data = filter(honey_region, region == "West Coast"),
             aes(color = "West Coast")) +
  scale_color_manual(values = "#C55644") +
  theme(
    legend.title = element_blank(),
    legend.position = c(0.3, 0.9),
    legend.box.background = element_rect(color = "black"),
    legend.box.margin = margin(t = -.05, unit = "cm"),
  ) +
  labs(
    title = "States Total Honey Production Over Time",
    subtitle = "<span style = 'color: #C55644'>**West Coast**</span> compared to other states",
    caption = "Non West Coast states are shown in grey:
    West Coast states include California, Oregon and Washington",
    y = "Total Honey Production"
  ) +
  theme(plot.subtitle = ggtext::element_markdown())
plot
```

## Number 2
Reproduce the plot according three different kinds of color blindness, as well as a desaturated version.
```{r}
cvdPlot(plot)
```

## Number 3
Reproduce the plot using a color blind safe palette.
```{r}
plot_plain <- ggplot(honey_region, aes(year, totalprod)) +
  geom_point(color = "grey80") +
  geom_point(data = filter(honey_region, region == "West Coast"),
             aes(color = "West Coast")) +
  scale_color_manual(values = "#C55644") +
  theme(
    legend.title = element_blank(),
    legend.position = c(0.3, 0.9),
    legend.box.background = element_rect(color = "black"),
    legend.box.margin = margin(t = -.05, unit = "cm"),
  ) +
  labs(
    title = "States Total Honey Production Over Time",
    subtitle = "West Coast compared to other states",
    caption = "Non West Coast states are shown in grey",
    y = "Total Honey Production"
  ) #needed to remove the html code so that it would still read the same
plot_plain

plot_clbnd <- plot_plain +
  theme_igray()
  scale_colour_colorblind()
plot_clbnd
```

## Number 4
Download file with **region/division** of each state
```{r}
urlfile = "https://raw.githubusercontent.com/cphalpert/census-regions/master/us%20census%20bureau%20regions%20and%20divisions.csv"

reg2 <- read_csv(url(urlfile))

# Join reg2 with honey file
df <- merge(honey, reg2, by.x = "state", by.y = "State Code", all = TRUE)

# Produce a bar plot displaying average honey for each state (collapse years)
# Use color to highlight the region of the country the state is from
# Note any patterns
df %>% 
  group_by(state, Region) %>% 
  summarise(mean = mean(totalprod)) %>% 
  ggplot(aes(state, mean)) +
  geom_col(aes(fill = Region)) +
  scale_fill_brewer(palette = "Paired") +
  scale_x_discrete(expand = c(0, 0)) +
  coord_flip() +
  labs(x = "U.S. States and District of Columbia",
       y = "Average Honey Production",
       title = "Honey Production",
       subtitle = "Among the U.S. States and District of Columbia",
       caption = "U.S. honey production occurs primarily
       in Midwest and Western regions") +
  theme(plot.titlt = element_text(hjust = 0, size = 18, face = "bold")) +
  theme(axis.title = element_text(size = 14, face = "bold", colour = "black")) +
  theme(panel.background = element_blank())

```
